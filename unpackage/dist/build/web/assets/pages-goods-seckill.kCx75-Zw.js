import{_ as s}from"./s-empty.tLh6VNZu.js";import{j as e,f as t,w as o,k as l,p as a,t as i,x as c,i as n,z as d,s as u,d as r,v as f,c as m,U as p,o as g,r as k,e as _,u as b,ad as v,l as x,g as y,y as I,ae as w,F as S,ab as h,ac as C,C as j,D as L}from"./index-BYbmVHYF.js";import{_ as T}from"./su-swiper.D_u09TM1.js";import{_ as P}from"./s-select-seckill-sku.BoBwVyOe.js";import{S as $}from"./s-layout.B9Wf0wyf.js";import{d as A,f as U,u as D}from"./useGoods.BAFIflfD.js";import{d as E,a as M,_ as V,b as R,c as z,e as F}from"./detail-content-card.Gean4cXK.js";import{_ as N}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{S as q}from"./seckill.DviVaf9U.js";import{S as B}from"./spu.DkDzSSyF.js";import{m as G}from"./min.BPJjMKdV.js";import"./su-number-box.BEEzrRQc.js";import"./index.DEmjmW11.js";import"./favorite.BwoPvFbi.js";import"./comment-item.BlObvZo_.js";import"./uni-rate.D7-6BT-5.js";import"./su-image.n6Vf7wmt.js";import"./mp-html.Mojn4hmC.js";const H=N({__name:"detail-progress",props:{percent:{type:Number,default:0}},setup:s=>(d,u)=>{const r=n;return e(),t(r,{class:"ss-flex ss-col-center"},{default:o((()=>[l(r,{class:"progress-title ss-m-r-10"},{default:o((()=>[a(" 已抢"+i(s.percent)+"% ",1)])),_:1}),l(r,{class:"progress-box ss-flex ss-col-center"},{default:o((()=>[l(r,{class:"progerss-active",style:c({width:s.percent<10?"10%":s.percent+"%"})},null,8,["style"])])),_:1})])),_:1})}},[["__scopeId","data-v-58b2423c"]]),J=N({__name:"seckill",setup(c){d((s=>({"73d00b06":b(N),"7c504cd6":b(J),"21972a8c":b(K),"5c668b2e":b(O),"9d73d7d0":b(Z)})));const N=u.$url.css("/static/img/shop/goods/seckill-bg.png"),J=u.$url.css("/static/img/shop/goods/seckill-btn.png"),K=u.$url.css("/static/img/shop/goods/activity-btn-disabled.png"),O=u.$url.css("/static/img/shop/goods/seckill-tip-bg.png"),Z=u.$url.css("/static/img/shop/goods/groupon-tip-bg.png");r((()=>{}));const Q=f({skeletonLoading:!0,goodsInfo:{},showSelectSku:!1,goodsSwiper:[],selectedSku:{},showModel:!1,total:0,percent:0,price:""}),W=m((()=>D(es.value.endTime)));function X(s){Q.selectedSku=s}function Y(s){u.$router.go("/pages/order/confirm",{data:JSON.stringify({order_type:"goods",buy_type:"seckill",seckillActivityId:es.value.id,items:[{skuId:s.id,count:s.count}]})})}const ss=m((()=>h(b(es))?{}:u.$platform.share.getShareInfo({title:es.value.name,image:u.$url.cdn(Q.goodsInfo.picUrl),params:{page:C.SECKILL.value,query:es.value.id}},{type:"goods",title:es.value.name,image:u.$url.cdn(Q.goodsInfo.picUrl),price:U(Q.goodsInfo.price),marketPrice:U(Q.goodsInfo.marketPrice)}))),es=p(),ts=p(""),os=async s=>{const{data:e}=await B.getSpuDetail(s);e.activity_type="seckill",Q.goodsInfo=e,Q.goodsSwiper=A(Q.goodsInfo.sliderPicUrls),Q.goodsInfo.price=G([Q.goodsInfo.price,...es.value.products.map((s=>s.seckillPrice))]),e.skus.forEach((s=>{const e=es.value.products.find((e=>e.skuId===s.id));e?(s.price=e.seckillPrice,s.stock=Math.min(s.stock,e.stock)):s.stock=0,es.value.totalLimitCount>0&&es.value.singleLimitCount>0?s.limitCount=Math.min(es.value.totalLimitCount,es.value.singleLimitCount):es.value.totalLimitCount>0?s.limitCount=es.value.totalLimitCount:es.value.singleLimitCount>0&&(s.limitCount=es.value.singleLimitCount)})),Q.skeletonLoading=!1};return g((s=>{s.id?(async s=>{const{data:e}=await q.getSeckillActivity(s);es.value=e,ts.value=v(es.value.startTime,es.value.endTime),Q.percent=100-e.stock/e.totalStock*100,await os(e.spuId)})(s.id):Q.goodsInfo=null})),(c,d)=>{const r=k(_("s-empty"),s),f=k(_("su-swiper"),T),m=n,p=j,g=k(_("s-select-seckill-sku"),P),v=L,h=k(_("s-layout"),$);return e(),t(h,{onShareAppMessage:ss.value,navbar:"goods"},{default:o((()=>[l(E),Q.skeletonLoading?(e(),t(M,{key:0})):null===Q.goodsInfo||"seckill"!==Q.goodsInfo.activity_type||W.value.ms<=0?(e(),t(r,{key:1,text:"活动不存在或已结束",icon:"/static/soldout-empty.png",showAction:"",actionText:"再逛逛",actionUrl:"/pages/goods/list"})):(e(),x(S,{key:2},[l(m,{class:"detail-swiper-selector"},{default:o((()=>[l(f,{class:"ss-m-b-14",isPreview:"",list:Q.goodsSwiper,dotStyle:"tag",imageMode:"widthFix",dotCur:"bg-mask-40",seizeHeight:750},null,8,["list"]),l(m,{class:"title-card ss-m-y-14 ss-m-x-20 ss-p-x-20 ss-p-y-34"},{default:o((()=>[l(m,{class:"price-box ss-flex ss-row-between ss-m-b-18"},{default:o((()=>[l(m,{class:"ss-flex"},{default:o((()=>[l(m,{class:"price-text ss-m-r-16"},{default:o((()=>[a(i(b(U)(Q.selectedSku.price||Q.goodsInfo.price)),1)])),_:1}),l(m,{class:"tig ss-flex ss-col-center"},{default:o((()=>[l(m,{class:"tig-icon ss-flex ss-col-center ss-row-center"},{default:o((()=>[l(p,{class:"cicon-alarm"})])),_:1}),l(m,{class:"tig-title"},{default:o((()=>[a("秒杀价")])),_:1})])),_:1})])),_:1}),W.value.ms>0?(e(),t(m,{key:0,class:"countdown-box"},{default:o((()=>[l(m,{class:"countdown-title ss-m-b-20"},{default:o((()=>[a("距结束仅剩")])),_:1}),l(m,{class:"ss-flex countdown-time"},{default:o((()=>[l(m,{class:"ss-flex countdown-h"},{default:o((()=>[a(i(W.value.h),1)])),_:1}),l(m,{class:"ss-m-x-4"},{default:o((()=>[a(":")])),_:1}),l(m,{class:"countdown-num ss-flex ss-row-center"},{default:o((()=>[a(i(W.value.m),1)])),_:1}),l(m,{class:"ss-m-x-4"},{default:o((()=>[a(":")])),_:1}),l(m,{class:"countdown-num ss-flex ss-row-center"},{default:o((()=>[a(i(W.value.s),1)])),_:1})])),_:1})])),_:1})):(e(),t(m,{key:1,class:"countdown-title"},{default:o((()=>[a(" 活动已结束 ")])),_:1}))])),_:1}),l(m,{class:"ss-flex ss-row-between ss-m-b-60"},{default:o((()=>[Q.goodsInfo.marketPrice?(e(),t(m,{key:0,class:"origin-price ss-flex ss-col-center"},{default:o((()=>[a(" 原价 "),l(m,{class:"origin-price-text"},{default:o((()=>[a(i(b(U)(Q.selectedSku.marketPrice||Q.goodsInfo.marketPrice)),1)])),_:1})])),_:1})):y("",!0),l(H,{percent:Q.percent},null,8,["percent"])])),_:1}),l(m,{class:"title-text ss-line-2 ss-m-b-6"},{default:o((()=>[a(i(Q.goodsInfo.name||""),1)])),_:1}),l(m,{class:"subtitle-text ss-line-1"},{default:o((()=>[a(i(Q.goodsInfo.introduction),1)])),_:1})])),_:1}),l(m,{class:"detail-cell-card detail-card ss-flex-col"},{default:o((()=>[l(V,{sku:Q.selectedSku,onClick:d[0]||(d[0]=s=>Q.showSelectSku=!0)},null,8,["sku"])])),_:1}),l(g,{modelValue:Q.goodsInfo,"onUpdate:modelValue":d[1]||(d[1]=s=>Q.goodsInfo=s),show:Q.showSelectSku,"single-limit-count":es.value.singleLimitCount,onBuy:Y,onChange:X,onClose:d[2]||(d[2]=s=>Q.showSelectSku=!1)},null,8,["modelValue","show","single-limit-count"])])),_:1}),l(R,{class:"detail-comment-selector",goodsId:Q.goodsInfo.id},null,8,["goodsId"]),l(z,{class:"detail-content-selector",content:Q.goodsInfo.description},null,8,["content"]),l(F,{modelValue:Q.goodsInfo,"onUpdate:modelValue":d[5]||(d[5]=s=>Q.goodsInfo=s)},{default:o((()=>[l(m,{class:"buy-box ss-flex ss-col-center ss-p-r-20"},{default:o((()=>[Q.goodsInfo.marketPrice?(e(),t(v,{key:0,class:"ss-reset-button origin-price-btn ss-flex-col",onClick:d[3]||(d[3]=s=>b(u).$router.go("/pages/goods/index",{id:Q.goodsInfo.id}))},{default:o((()=>[l(m,null,{default:o((()=>[l(m,{class:"btn-price"},{default:o((()=>[a(i(b(U)(Q.goodsInfo.marketPrice)),1)])),_:1}),l(m,null,{default:o((()=>[a("原价购买")])),_:1})])),_:1})])),_:1})):(e(),t(v,{key:1,class:"ss-reset-button origin-price-btn ss-flex-col"},{default:o((()=>[l(m,{class:I(["no-original",(0===Q.goodsInfo.stock||(ts.value,b(w).STARTED),"")])},{default:o((()=>[a(" 秒杀价 ")])),_:1},8,["class"])])),_:1})),l(v,{class:I(["ss-reset-button btn-box ss-flex-col",ts.value===b(w).STARTED&&0!=Q.goodsInfo.stock?"check-btn-box":"disabled-btn-box"]),onClick:d[4]||(d[4]=s=>Q.showSelectSku=!0),disabled:0===Q.goodsInfo.stock||ts.value!==b(w).STARTED},{default:o((()=>[l(m,{class:"btn-price"},{default:o((()=>[a(i(b(U)(Q.goodsInfo.price)),1)])),_:1}),ts.value===b(w).STARTED?(e(),t(m,{key:0},{default:o((()=>[0===Q.goodsInfo.stock?(e(),t(m,{key:0},{default:o((()=>[a("已售罄")])),_:1})):(e(),t(m,{key:1},{default:o((()=>[a("立即秒杀")])),_:1}))])),_:1})):(e(),t(m,{key:1},{default:o((()=>[a(i(ts.value),1)])),_:1}))])),_:1},8,["class","disabled"])])),_:1})])),_:1},8,["modelValue"])],64))])),_:1},8,["onShareAppMessage"])}}},[["__scopeId","data-v-8e9189f5"]]);export{J as default};
