"use strict";const e=require("../../../../common/vendor.js"),s=require("../../../index.js"),t=require("./poster/index.js");if(!Array){(e.resolveComponent("l-painter")+e.resolveComponent("su-popup"))()}Math||((()=>"../../../../uni_modules/lime-painter/components/l-painter/l-painter.js")+(()=>"../../../ui/su-popup/su-popup.js"))();const o={__name:"index",props:{show:{type:Boolean,default:!1},shareInfo:{type:Object,default:()=>{}}},emits:["success","close"],setup(o,{expose:a,emit:i}){const n=o,p=e.reactive({css:{width:.9*s.sheep.$platform.device.windowWidth,height:600},views:[]}),r=i,c=()=>{r("close")},l=e.ref(),u=e.ref(),h=e=>{u.value=e},f=()=>{["WechatOfficialAccount","H5"].includes(s.sheep.$platform.name)?s.sheep.$helper.toast("请长按图片保存"):e.index.saveImageToPhotosAlbum({filePath:u.value,success:e=>{c(),s.sheep.$helper.toast("保存成功")},fail:e=>{s.sheep.$helper.toast("保存失败"),console.log("图片保存失败:",e)}})};return a({getPoster:async function(){u.value=void 0,p.views=await t.getPosterData({width:p.css.width,shareInfo:n.shareInfo}),await(async()=>{await l.value.render(e.unref(p))})()}}),(t,a)=>e.e({a:!!u.value},u.value?{b:u.value,c:p.css.height+"px",d:p.css.width+"px"}:{},{e:!!u.value},u.value?{f:e.o(c),g:e.t(["wechatOfficialAccount","H5"].includes(e.unref(s.sheep).$platform.name)?"长按图片保存":"保存图片"),h:e.o(f)}:{},{i:e.sr(l,"28834cf2-1,28834cf2-0",{k:"painterRef"}),j:e.o(h),k:e.p({isCanvasToTempFilePath:!0,pathType:"url",hidden:!0}),l:e.o(c),m:e.p({show:o.show,round:"10",type:"center"})})}},a=e._export_sfc(o,[["__scopeId","data-v-28834cf2"]]);wx.createComponent(a);
