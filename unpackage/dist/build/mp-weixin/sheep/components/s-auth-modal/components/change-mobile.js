"use strict";const e=require("../../../../common/vendor.js"),o=require("../../../index.js"),n=require("../../../validate/form.js"),r=require("../../../hooks/useModal.js"),i=require("../../../api/member/user.js");if(!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../../../uni_modules/uni-forms/components/uni-forms/uni-forms.js"))();const l={__name:"change-mobile",setup(l){const s=e.ref(null),m=e.computed((()=>o.sheep.$store("user").userInfo)),t=e.reactive({isMobileEnd:!1,model:{mobile:"",code:""},rules:{code:n.code,mobile:n.mobile}});async function u(){if(!(await e.unref(s).validate().catch((e=>{console.log("error: ",e)}))))return;const{code:n}=await i.UserApi.updateUserMobile(t.model);0===n&&(o.sheep.$store("user").getInfo(),r.closeAuthModal())}async function a(e){if("getPhoneNumber:ok"!==e.detail.errMsg)return;await o.sheep.$platform.useProvider().bindUserPhoneNumber(e.detail)&&(o.sheep.$store("user").getInfo(),r.closeAuthModal())}return(n,i)=>e.e({a:e.t(m.value.mobile?"更换手机号":"绑定手机号"),b:e.t(e.unref(r.getSmsTimer)("changeMobile")),c:t.isMobileEnd,d:t.isMobileEnd?1:"",e:e.o((o=>e.unref(r.getSmsCode)("changeMobile",t.model.mobile))),f:e.o((e=>t.model.mobile=e)),g:e.p({placeholder:"请输入手机号",inputBorder:!1,type:"number",modelValue:t.model.mobile}),h:e.p({name:"mobile",label:"手机号"}),i:e.o(u),j:e.o((e=>t.model.code=e)),k:e.p({placeholder:"请输入验证码",inputBorder:!1,type:"number",maxlength:"4",modelValue:t.model.code}),l:e.p({name:"code",label:"验证码"}),m:e.sr(s,"0241a05b-0",{k:"changeMobileRef"}),n:e.o((e=>t.model=e)),o:e.p({rules:t.rules,validateTrigger:"bind",labelWidth:"140",labelAlign:"center",modelValue:t.model}),p:"WechatMiniProgram"===e.unref(o.sheep).$platform.name},"WechatMiniProgram"===e.unref(o.sheep).$platform.name?{q:e.o(a)}:{})}},s=e._export_sfc(l,[["__scopeId","data-v-0241a05b"]]);wx.createComponent(s);
