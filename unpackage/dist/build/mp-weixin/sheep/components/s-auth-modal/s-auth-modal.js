"use strict";const e=require("../../../common/vendor.js"),o=require("../../index.js"),a=require("../../hooks/useModal.js");if(!Array){e.resolveComponent("su-popup")()}Math||(t+s+n+r+u+p+(()=>"../../ui/su-popup/su-popup.js"))();const t=()=>"./components/account-login.js",s=()=>"./components/sms-login.js",n=()=>"./components/reset-password.js",r=()=>"./components/change-mobile.js",u=()=>"./components/change-password.js",p=()=>"./components/mp-authorization.js",l={__name:"s-auth-modal",setup(t){const s=o.sheep.$store("modal"),n=e.computed((()=>s.auth)),r=e.reactive({protocol:!1}),u=e.ref(!1);function p(){r.protocol=!r.protocol}function l(e){a.closeAuthModal(),o.sheep.$router.go("/pages/public/richtext",{title:e})}function i(e){u.value=e,setTimeout((()=>{u.value=!1}),1e3)}const c=async e=>{if(!r.protocol)return u.value=!0,setTimeout((()=>{u.value=!1}),1e3),void o.sheep.$helper.toast("请勾选同意");if(await o.sheep.$platform.useProvider(e).login()){const e=await o.sheep.$store("user").getInfo();if(a.closeAuthModal(),e.avatar&&e.nickname)return;a.showAuthModal("mpAuthorization")}},m=async e=>{if("getPhoneNumber:ok"!==e.detail.errMsg)return void o.sheep.$helper.toast("快捷登录失败");await o.sheep.$platform.useProvider().mobileLogin(e.detail)&&a.closeAuthModal()};return(t,s)=>e.e({a:"accountLogin"===n.value},"accountLogin"===n.value?{b:e.o(i),c:e.p({agreeStatus:r.protocol})}:{},{d:"smsLogin"===n.value},"smsLogin"===n.value?{e:e.o(i),f:e.p({agreeStatus:r.protocol})}:{},{g:"resetPassword"===n.value},(n.value,{}),{h:"changeMobile"===n.value},(n.value,{}),{i:"changePassword"===n.value},(n.value,{}),{j:"mpAuthorization"===n.value},(n.value,{}),{k:["accountLogin","smsLogin"].includes(n.value)},["accountLogin","smsLogin"].includes(n.value)?e.e({l:"WechatMiniProgram"===e.unref(o.sheep).$platform.name},"WechatMiniProgram"===e.unref(o.sheep).$platform.name?{m:e.o(m)}:{},{n:["WechatOfficialAccount","WechatMiniProgram","App"].includes(e.unref(o.sheep).$platform.name)&&e.unref(o.sheep).$platform.isWechatInstalled},["WechatOfficialAccount","WechatMiniProgram","App"].includes(e.unref(o.sheep).$platform.name)&&e.unref(o.sheep).$platform.isWechatInstalled?{o:e.unref(o.sheep).$url.static("/static/img/shop/platform/wechat.png"),p:e.o((e=>c("wechat")))}:{},{q:"ios"===e.unref(o.sheep).$platform.os&&"App"===e.unref(o.sheep).$platform.name},"ios"===e.unref(o.sheep).$platform.os&&"App"===e.unref(o.sheep).$platform.name?{r:e.unref(o.sheep).$url.static("/static/img/shop/platform/apple.png"),s:e.o((e=>c("apple")))}:{}):{},{t:["accountLogin","smsLogin"].includes(n.value)},["accountLogin","smsLogin"].includes(n.value)?{v:r.protocol,w:e.o(p),x:e.o((e=>l("用户协议"))),y:e.o((e=>l("隐私协议"))),z:e.o(p),A:u.value?1:""}:{},{B:e.o(e.unref(a.closeAuthModal)),C:e.p({show:""!==n.value,round:"10",showClose:!0})})}},i=e._export_sfc(l,[["__scopeId","data-v-353df301"]]);wx.createComponent(i);
