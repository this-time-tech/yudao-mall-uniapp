"use strict";const e=require("../../common/vendor.js"),o=require("../../sheep/index.js"),n=require("../../sheep/hooks/useModal.js"),a=require("../../sheep/api/infra/file.js"),i=require("../../sheep/api/member/user.js");if(!Array){(e.resolveComponent("su-image")+e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("su-radio")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("uni-forms")+e.resolveComponent("su-fixed")+e.resolveComponent("s-layout"))()}Math||((()=>"../../sheep/ui/su-image/su-image.js")+(()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../sheep/ui/su-radio/su-radio.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms/uni-forms.js")+(()=>"../../sheep/ui/su-fixed/su-fixed.js")+(()=>"../../sheep/components/s-layout/s-layout.js"))();const t={__name:"info",setup(t){const s=e.reactive({model:{},rules:{},thirdInfo:{}}),l=[{name:"男",value:"1"},{name:"女",value:"2"}],r=e.computed((()=>o.sheep.$store("user").userInfo));function u(e){s.model.sex=e.detail.value}const p=()=>{n.showAuthModal("changeMobile")};function m(e){!async function(e){if(!e)return;let{data:o}=await a.FileApi.uploadFile(e);s.model.avatar=o}(e.detail.avatarUrl||"")}function c(){n.showAuthModal("changePassword")}async function d(){await o.sheep.$platform.useProvider("wechat").bind()&&await v()}function f(){e.index.showModal({title:"解绑提醒",content:"解绑后您将无法通过微信登录此账号",cancelText:"再想想",confirmText:"确定",success:async function(e){if(!e.confirm)return;await o.sheep.$platform.useProvider("wechat").unbind(s.thirdInfo.openid)&&await v()}})}async function h(){const{code:e}=await i.UserApi.updateUser({avatar:s.model.avatar,nickname:s.model.nickname,sex:s.model.sex});0===e&&await v()}const v=async()=>{const n=await o.sheep.$store("user").getInfo();if(s.model=e.clone(n),"H5"!==o.sheep.$platform.name){const e=await o.sheep.$platform.useProvider("wechat").getInfo();s.thirdInfo=e||{}}};return e.onBeforeMount((()=>{v()})),(n,a)=>{var i,t,v,b,w;return e.e({a:e.p({isPreview:!0,current:0,src:null==(i=s.model)?void 0:i.avatar,height:160,width:160,radius:80,mode:"scaleToFill"}),b:e.o(m),c:e.o((e=>s.model.nickname=e)),d:e.p({type:"nickname",placeholder:"设置昵称",inputBorder:!1,placeholderStyle:"color:#BBBBBB;font-size:28rpx;line-height:normal",modelValue:s.model.nickname}),e:e.p({name:"nickname",label:"昵称"}),f:e.f(l,((o,n,a)=>{var i;return{a:o.value,b:parseInt(o.value)===(null==(i=s.model)?void 0:i.sex),c:e.t(o.name),d:o.value}})),g:e.o(u),h:e.p({name:"sex",label:"性别"}),i:null==(t=r.value.verification)?void 0:t.mobile},(null==(v=r.value.verification)?void 0:v.mobile)?{j:e.p({modelValue:!0})}:{},{k:e.o((e=>r.value.mobile=e)),l:e.p({placeholder:"请绑定手机号",inputBorder:!1,disabled:!0,styles:{disableColor:"#fff"},placeholderStyle:"color:#BBBBBB;font-size:28rpx;line-height:normal",clearable:!1,modelValue:r.value.mobile}),m:e.o(p),n:e.p({name:"mobile",label:"手机号"}),o:null==(b=r.value.verification)?void 0:b.password},(null==(w=r.value.verification)?void 0:w.password)?{p:e.p({modelValue:!0})}:{},{q:e.o((e=>r.value.password=e)),r:e.p({placeholder:"点击修改登录密码",inputBorder:!1,styles:{disableColor:"#fff"},disabled:!0,placeholderStyle:"color:#BBBBBB;font-size:28rpx;line-height:normal",clearable:!1,modelValue:r.value.password}),s:e.o(c),t:e.p({name:"password",label:"登录密码"}),v:e.o((n=>e.unref(o.sheep).$router.go("/pages/user/address/list"))),w:e.p({clickable:!0,title:"地址管理",showArrow:!0,border:!1}),x:e.p({model:s.model,rules:s.rules,labelPosition:"left",border:!0}),y:"H5"!==e.unref(o.sheep).$platform.name},"H5"!==e.unref(o.sheep).$platform.name?e.e({z:"WechatOfficialAccount"===e.unref(o.sheep).$platform.name},"WechatOfficialAccount"===e.unref(o.sheep).$platform.name?{A:e.unref(o.sheep).$url.static("/static/img/shop/platform/WechatOfficialAccount.png")}:{},{B:"WechatMiniProgram"===e.unref(o.sheep).$platform.name},"WechatMiniProgram"===e.unref(o.sheep).$platform.name?{C:e.unref(o.sheep).$url.static("/static/img/shop/platform/WechatMiniProgram.png")}:{},{D:"App"===e.unref(o.sheep).$platform.name},"App"===e.unref(o.sheep).$platform.name?{E:e.unref(o.sheep).$url.static("/static/img/shop/platform/wechat.png")}:{},{F:s.thirdInfo},s.thirdInfo?{G:e.unref(o.sheep).$url.cdn(s.thirdInfo.avatar),H:e.t(s.thirdInfo.nickname)}:{},{I:s.thirdInfo.openid},s.thirdInfo.openid?{J:e.o(f)}:{K:e.o(d)}):{},{L:e.o(h),M:e.p({bottom:!0,placeholder:!0,bg:"none"}),N:e.p({title:"用户信息"})})}}},s=e._export_sfc(t,[["__scopeId","data-v-3c8b1656"]]);wx.createPage(s);
